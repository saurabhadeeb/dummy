<% unless @error.blank?  %>
  <% @page_title="Sorry" %>
<div style="text-align: center; margin-top: 30px">
  <img src="/assets/oops-doh-1.jpg"/>
  <h2>Ooops!!</h2>
  <h3>An error occurred in the search for "<%= params[:id] %>" and tweets could not be retrieved</h3>
</div>
<% else %>
  
    <% @page_title="Twitter Search Results: #{params[:id]}" %>
    <style>
      .TweetTable {
        margin:auto 10%;
      }
      .CSSTableGenerator {
            margin:0px;padding:0px;
            width:100%;
            box-shadow: 10px 10px 5px #888888;
            border:1px solid #000000;
          
            -moz-border-radius-bottomleft:13px;
            -webkit-border-bottom-left-radius:13px;
            border-bottom-left-radius:13px;
          
            -moz-border-radius-bottomright:13px;
            -webkit-border-bottom-right-radius:13px;
            border-bottom-right-radius:13px;
          
            -moz-border-radius-topright:13px;
            -webkit-border-top-right-radius:13px;
            border-top-right-radius:13px;
          
            -moz-border-radius-topleft:13px;
            -webkit-border-top-left-radius:13px;
            border-top-left-radius:13px;
    }.CSSTableGenerator table{
        border-collapse: collapse;
            border-spacing: 0;
            width:100%;
            height:100%;
            margin:0px;padding:0px;
    }.CSSTableGenerator tr:last-child td:last-child {
            -moz-border-radius-bottomright:13px;
            -webkit-border-bottom-right-radius:13px;
            border-bottom-right-radius:13px;
    }
    .CSSTableGenerator table tr:first-child td:first-child {
            -moz-border-radius-topleft:13px;
            -webkit-border-top-left-radius:13px;
            border-top-left-radius:13px;
    }
    .CSSTableGenerator table tr:first-child td:last-child {
            -moz-border-radius-topright:13px;
            -webkit-border-top-right-radius:13px;
            border-top-right-radius:13px;
    }.CSSTableGenerator tr:last-child td:first-child{
            -moz-border-radius-bottomleft:13px;
            -webkit-border-bottom-left-radius:13px;
            border-bottom-left-radius:13px;
    }.CSSTableGenerator tr:hover td{
          
    }
    .CSSTableGenerator tr:nth-child(odd){ background-color:#aad4ff; }
    .CSSTableGenerator tr:nth-child(even)    { background-color:#ffffff; }.CSSTableGenerator td{
            vertical-align:middle;
          
          
            border:1px solid #000000;
            border-width:0px 1px 1px 0px;
            text-align:left;
            padding:9px;
            font-size:10pt;
            font-family:Verdana;
            font-weight:normal;
            color:#000000;
    }.CSSTableGenerator tr:last-child td{
            border-width:0px 1px 0px 0px;
    }.CSSTableGenerator tr td:last-child{
            border-width:0px 0px 1px 0px;
    }.CSSTableGenerator tr:last-child td:last-child{
            border-width:0px 0px 0px 0px;
    }
    .CSSTableGenerator tr:first-child td{
                    background:-o-linear-gradient(bottom, #005fbf 5%, #003f7f 100%);	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #005fbf), color-stop(1, #003f7f) );
            background:-moz-linear-gradient( center top, #005fbf 5%, #003f7f 100% );
            filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#005fbf", endColorstr="#003f7f");	background: -o-linear-gradient(top,#005fbf,003f7f);
  
            background-color:#005fbf;
            border:0px solid #000000;
            text-align:center;
            border-width:0px 0px 1px 1px;
            font-size:12pt;
            font-family:Verdana;
            font-weight:bold;
            color:#ffffff;
    }
    .CSSTableGenerator tr:first-child:hover td{
            background:-o-linear-gradient(bottom, #005fbf 5%, #003f7f 100%);	background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #005fbf), color-stop(1, #003f7f) );
            background:-moz-linear-gradient( center top, #005fbf 5%, #003f7f 100% );
            filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#005fbf", endColorstr="#003f7f");	background: -o-linear-gradient(top,#005fbf,003f7f);
  
            background-color:#005fbf;
    }
    .CSSTableGenerator tr:first-child td:first-child{
            border-width:0px 0px 1px 0px;
    }
    .CSSTableGenerator tr:first-child td:last-child{
            border-width:0px 0px 1px 1px;
    }
    
    .textEntryContainer {
          text-align: center;
          margin: 10px 10%;
          font-size: 1.2em;
    }
    .qtext {
          -webkit-border-radius: 28;
          -moz-border-radius: 28;
          border-radius: 28px;
          font-family: Verdana;
          color: #0f0f0f;
          font-size: 10pt;
          padding: 10px 20px 10px 20px;
          text-decoration: none;
          width: 300px;
    }

    .qtext:focus {
          outline: none;
          border-color: #ff0f00;
    }
    
    .btn {
      background: #3498db;
      background-image: -webkit-linear-gradient(top, #3498db, #2980b9);
      background-image: -moz-linear-gradient(top, #3498db, #2980b9);
      background-image: -ms-linear-gradient(top, #3498db, #2980b9);
      background-image: -o-linear-gradient(top, #3498db, #2980b9);
      background-image: linear-gradient(to bottom, #3498db, #2980b9);
      -webkit-border-radius: 28;
      -moz-border-radius: 28;
      border-radius: 28px;
      font-family: Verdana;
      color: #f8f8f8;
      font-size: 10pt;
      padding: 10px 20px 10px 20px;
      text-decoration: none;
    }

    .btn:hover {
      background: #3cb0fd;
      background-image: -webkit-linear-gradient(top, #3cb0fd, #3498db);
      background-image: -moz-linear-gradient(top, #3cb0fd, #3498db);
      background-image: -ms-linear-gradient(top, #3cb0fd, #3498db);
      background-image: -o-linear-gradient(top, #3cb0fd, #3498db);
      background-image: linear-gradient(to bottom, #3cb0fd, #3498db);
      text-decoration: none;
    }

    </style>
    <div class="textEntryContainer">
      <form action="/twitter/search" method="get">
      <strong>New Search: </strong>
      <%= text_field_tag 'id', nil, :class => 'qtext', :placeholder => 'Enter search term...' %>
      <%= submit_tag nil, :class => "btn" %>
      </form>
    </div>
    <h2 style="margin:auto 10%">Recent tweets with unique URLs for "<%= params[:id] %>"</h2>
    <div class="TweetTable">
      <div class="CSSTableGenerator">
        <table>
          <tr>
            <td>Sl. No.</td>
            <td>Time</td>
            <td>User</td>
            <td>Tweeted Text</td>
            <td>URL</td>
          </tr>
          <% @tweets.each_with_index do |t, row_num| %>
            <tr>
              <td><%= (row_num+1).to_s + "." %></td>
              <td>
                <% date=DateTime.parse(t[:tweet].created_at.to_s) %>
                <%= date.strftime('%a %b %d, %Y at %H:%M') %>
              </td>
              <td>
                <%= t[:tweet].user.name %>
              </td>
              <td>
                <%= auto_link(t[:tweet].text, :html => { :target => '_blank' }) %>
              </td>
              <td>
                <a href="<%= t[:url] %>" target="_blank"><%= URI.parse(URI.encode(t[:url].squish)).host %></a>
              </td>
            </tr>
          <% end %>
        </table>
      </div>
    </div>
  <% end %>
